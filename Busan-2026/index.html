<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#f3f1ee" />
  <title>2026 æœ€å¸¥ç”·åœ˜ IN BUSAN</title>
  <style>
    :root{
      --bg:#f3f1ee;         /* è«è˜­è¿ªç±³ç™½ */
      --card:#ffffffcc;
      --ink:#1f2937;
      --muted:#6b7280;
      --line:#e5e7eb;
      --brand:#6b7280;      /* ç°è— */
      --brand2:#8b7b6b;     /* ç°æ£• */
      --ok:#0f766e;
      --warn:#b45309;
      --bad:#b91c1c;
      --shadow: 0 10px 30px rgba(31,41,55,.08);
      --radius: 18px;
      --radius2: 14px;
      --safeB: env(safe-area-inset-bottom, 0px);
      --safeT: env(safe-area-inset-top, 0px);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: system-ui, -apple-system, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", sans-serif;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--ink);
      background:
        radial-gradient(1200px 600px at 10% -10%, rgba(107,114,128,.18), transparent 60%),
        radial-gradient(900px 500px at 90% 0%, rgba(139,123,107,.16), transparent 55%),
        var(--bg);
      padding-bottom: calc(84px + var(--safeB));
    }
    header{
      position:sticky; top:0; z-index:30;
      background: linear-gradient(to bottom, rgba(243,241,238,.96), rgba(243,241,238,.72));
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--line);
      padding: calc(14px + var(--safeT)) 16px 12px;
    }
    .title{
      display:flex; align-items:flex-start; justify-content:space-between; gap:12px;
      max-width:1040px; margin:0 auto;
    }
    .title h1{
      margin:0;
      font-size: 18px;
      letter-spacing:.2px;
      line-height:1.25;
    }
    .title .sub{
      margin-top:6px;
      font-size: 12px;
      color:var(--muted);
      line-height:1.4;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border:1px solid var(--line);
      border-radius:999px;
      background:rgba(255,255,255,.75);
      box-shadow: 0 6px 16px rgba(31,41,55,.06);
      white-space:nowrap;
      font-size:12px;
      color:var(--muted);
    }
    .pill b{color:var(--ink); font-weight:700}
    main{max-width:1040px; margin:0 auto; padding:16px}
    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    @media (min-width: 920px){
      .grid{grid-template-columns: 1.2fr .8fr;}
      .grid .full{grid-column: 1 / -1;}
    }
    .maplink,
    .maplink:visited{
      color:var(--muted);
      text-decoration:none;
      border-bottom:1px dashed rgba(107,114,128,.4);
    }
    .maplink:hover{
      color:var(--ink);
      border-bottom-color:var(--ink);
    }


    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:14px 14px 10px;
      border-bottom:1px solid var(--line);
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
    }
    .card .hd h2{
      margin:0;
      font-size:15px;
      letter-spacing:.2px;
    }
    .card .hd .hint{
      font-size:12px;
      color:var(--muted);
      line-height:1.4;
      text-align:right;
      white-space:nowrap;
    }
    .card .bd{padding:14px}
    .tabs{
      position:fixed; left:0; right:0; bottom:0;
      z-index:40;
      padding:10px 12px calc(10px + var(--safeB));
      background: linear-gradient(to top, rgba(243,241,238,.98), rgba(243,241,238,.70));
      backdrop-filter: blur(10px);
      border-top:1px solid var(--line);
    }
    .tabbar{
      max-width:1040px; margin:0 auto;
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
    }
    .tabbtn{
      appearance:none; border:1px solid var(--line);
      background: rgba(255,255,255,.72);
      border-radius: 999px;
      padding:10px 10px;
      font-size:13px;
      color:var(--muted);
      display:flex; align-items:center; justify-content:center; gap:8px;
      cursor:pointer;
      box-shadow: 0 8px 20px rgba(31,41,55,.07);
    }
    .tabbtn.active{
      border-color: rgba(107,114,128,.35);
      background: #fff;
      color: var(--ink);
      font-weight:700;
    }
    .row{display:flex; gap:10px; flex-wrap:wrap}
    .field{
      flex:1 1 160px;
      display:flex; flex-direction:column; gap:6px;
      min-width: 140px;
    }
    label{font-size:12px; color:var(--muted)}
    input, select, textarea{
      width:100%;
      padding:10px 10px;
      border:1px solid var(--line);
      border-radius: 12px;
      background: rgba(255,255,255,.9);
      font-family: var(--sans);
      font-size:14px;
      outline:none;
    }
    textarea{min-height:44px; resize:vertical}
    input:focus, select:focus, textarea:focus{
      border-color: rgba(107,114,128,.55);
      box-shadow: 0 0 0 4px rgba(107,114,128,.12);
    }
    .btn{
      appearance:none;
      border:1px solid rgba(107,114,128,.35);
      background:#fff;
      color:var(--ink);
      border-radius: 14px;
      padding:10px 12px;
      font-size:13px;
      cursor:pointer;
      box-shadow: 0 10px 22px rgba(31,41,55,.08);
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      user-select:none;
      text-decoration:none;
    }
    .btn.secondary{
      background: rgba(255,255,255,.65);
      color:var(--muted);
      border-color: var(--line);
      box-shadow:none;
    }
    .btn.danger{
      border-color: rgba(185,28,28,.25);
      color: var(--bad);
    }
    .btn.ok{
      border-color: rgba(15,118,110,.25);
      color: var(--ok);
    }
    .badge{
      display:inline-flex; align-items:center; gap:6px;
      font-size:12px;
      padding:6px 10px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.7);
      color: var(--muted);
    }
    .mono{font-family:var(--mono)}
    .sep{height:1px; background:var(--line); margin:12px 0}
    .small{font-size:12px; color:var(--muted); line-height:1.5}
    .kpi{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .kpi .box{
      padding:12px;
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(255,255,255,.72);
    }
    .kpi .box .t{font-size:12px; color:var(--muted)}
    .kpi .box .v{margin-top:6px; font-size:16px; font-weight:800; letter-spacing:.2px}
    table{
      width:100%;
      border-collapse: separate;
      border-spacing:0;
      overflow:hidden;
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background:#fff;
    }
    th, td{
      padding:10px 10px;
      border-bottom:1px solid var(--line);
      font-size:13px;
      vertical-align:top;
    }
    th{
      background: rgba(243,241,238,.7);
      color: var(--muted);
      font-weight:700;
      text-align:left;
    }
    tr:last-child td{border-bottom:none}
    .tableWrap{overflow:auto}
    .hide{display:none !important}
    details{
      border:1px solid var(--line);
      border-radius: var(--radius2);
      background: rgba(255,255,255,.75);
      overflow:hidden;
    }
    summary{
      list-style:none;
      cursor:pointer;
      padding:12px 12px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      font-weight:800;
    }
    summary::-webkit-details-marker{display:none}
    .sumhint{font-size:12px; color:var(--muted); font-weight:600}
    .pad{padding:12px}
    .toast{
      position:fixed; left:50%; transform:translateX(-50%);
      bottom: calc(96px + var(--safeB));
      background: rgba(17,24,39,.92);
      color:#fff;
      padding:10px 12px;
      border-radius: 999px;
      font-size:13px;
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      z-index:60;
    }
    .toast.show{opacity:1; transform:translateX(-50%) translateY(-4px);}
    .right{display:flex; gap:8px; align-items:center; justify-content:flex-end; flex-wrap:wrap}

    /* è¨˜å¸³ï¼šé‡‘é¡æ¬„çš„é›™è¡Œé¡¯ç¤º */
    .amtMain{font-weight:800}
    .amtSub{margin-top:2px; font-size:12px; color:var(--muted)}

    /* ===== Mobile: Day summary å³å´è³‡è¨Šç¨ç«‹æˆä¸€è¡Œï¼ˆé¿å…è¢«åˆ‡æˆå…©æ®µï¼‰ ===== */
    @media (max-width: 640px){
      summary{
        display:flex;
        flex-wrap:wrap;
        gap:6px 10px;
      }
      summary .sumhint{
        flex: 0 0 100%;
        text-align: right;
        white-space: nowrap;
        font-size: 12px;
        color: var(--muted);
      }
    }

    /* ===== Mobile: è¡Œç¨‹è¡¨æ ¼æ”¹æˆã€Œå‚™è¨»ä¸‹ä¸€è¡Œå…¨å¯¬ã€ ===== */
    @media (max-width: 640px){
      /* æ‰‹æ©Ÿï¼šæŠŠè¡¨æ ¼å¤–æ¡†æ‹¿æ‰ï¼Œå…§å®¹å°±è·Ÿ summary åŒå¯¬ï¼Œä¸æœƒã€Œå±•é–‹è®Šçª„ã€ */
      table.itinTable{
        table-layout: auto;
        border: none;
        border-radius: 0;
        background: transparent;
      }
      table.itinTable thead{ display:none; }

      /* tableWrap åœ¨æ‰‹æ©Ÿä¸ç”¨æ©«å‘æ²å‹•ï¼Œé¿å…å…§ç¸®è¦–è¦º */
      .tableWrap{ overflow: visible; }

      table.itinTable tbody tr{
        display:grid;
        grid-template-columns: 92px minmax(0, 1fr) 44px;
        grid-auto-rows: auto;
        gap:4px 6px;
        padding:10px 0; /* ç”±å·¦å³ padding æ”¹æˆ 0ï¼šè·Ÿå¤–å±¤ .pad å°é½Š */
        border-bottom: 1px solid rgba(107,114,128,.16);
      }
      table.itinTable tbody tr:last-child{ border-bottom: none; }

      table.itinTable tbody td{
        border-bottom:none;
        padding:0;
      }
      /* 1:æ™‚é–“ 2:è¡Œç¨‹ 3:äº¤é€š åŒä¸€è¡Œ */
      table.itinTable tbody td:nth-child(1){
        grid-column:1;
        padding-right:4px;
        white-space:nowrap;
        font-size:12px;
      }
      table.itinTable tbody td:nth-child(2){ grid-column:2; }
      /* 2:è¡Œç¨‹ ç›¡é‡ç¶­æŒä¸€è¡Œï¼Œé¿å…è¢«æ‹†æˆå…©è¡Œï¼ˆå¤ªé•·å°±çœç•¥è™Ÿï¼‰ */
      table.itinTable tbody td:nth-child(2){
        grid-column:2;
        position: relative;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: clip; /* å–æ¶ˆ ...ï¼Œæ”¹ç”¨æ·¡å‡ºé®ç½© */
      }
      table.itinTable tbody td:nth-child(2)::after{
        content:"";
        position:absolute;
        top:0;
        right:0;
        width:32px;
        height:100%;
        pointer-events:none;
        background: linear-gradient(to right, rgba(255,255,255,0), rgba(255,255,255,1));
      }
      table.itinTable tbody td:nth-child(3){ grid-column:3; text-align:right; white-space:nowrap; font-size:12px; }
      /* 4:å‚™è¨» è®Šæˆä¸‹ä¸€è¡Œå…¨å¯¬ */
      table.itinTable tbody td:nth-child(4){
        grid-column: 1 / -1;
        margin-top:2px;
        padding-top:6px;
        border-top:1px dashed rgba(107,114,128,.16);
        color: var(--muted);
        font-size:12px;
        line-height:1.45;
        word-break: break-word;
      }
      /* ç©ºå‚™è¨»å°±ä¸ä½”é«˜åº¦ */
      table.itinTable tbody td:nth-child(4):empty{ display:none; }
    }

      /* è¡Œå‰æº–å‚™ï¼šä½èª¿é€£çµæŒ‰éˆ• */
      .pretrip-link{
        padding:6px 10px;
        font-size:12px;
        border-radius:999px;
        box-shadow:none;
        background: rgba(255,255,255,.55);
      }
      .pretrip-link:hover{
        background: rgba(255,255,255,.75);
      }

    
  </style>
</head>

<body>
<header>
  <div class="title">
    <div>
      <h1>2026 æœ€å¸¥ç”·åœ˜ IN BUSAN</h1>
      <div class="sub">
        ğŸ¨ è¥¿é¢ Hound Hotelï½œğŸ“<a
    class="maplink"
    href="https://map.naver.com/v5/search/10,%20Bujeon-ro%2020beon-gil,%20Busanjin-gu,%20Busan"
    target="_blank"
    rel="noopener"
  >10, Bujeon-ro 20beon-gil, Busanjin-gu, Busan, Korea</a>
      </div>
    </div>
    <div class="pill">
      <span>åŒ¯ç‡</span>
      <b id="rateBadge">â€”</b>
      <span class="mono">TWD / KRW</span>
    </div>
  </div>
</header>

<main>
  <!-- è¡Œç¨‹ -->
  <section id="view-itin" class="grid">
     
<!-- è¡Œå‰æº–å‚™å€ï¼šå‡ºç™¼å¾Œè‡ªå‹•éš±è— -->
<div id="pretripBlock">
  <div class="card full">
    <div class="hd">
      <h2>è¡Œå‰æº–å‚™</h2>
      <div class="hint"></div>
    </div>
    <div class="bd">
      <a class="btn secondary pretrip-link" href="./Packing.html">ğŸ§³ è¡Œææ¸…å–®</a>
    </div>
  </div>
</div>


    
    
    <div class="card full">
      <div class="hd">
        <h2>ğŸ—“ï¸ 5D 4N è¡Œç¨‹è¡¨</h2>
        <div class="hint"></div>
      </div>

      <div class="bd">
        <details open>
          <summary>
            Day 1 ï½œ 2026-01-21 ï½œ âœˆï¸ å°ç£ â†’ é‡œå±±
            <span class="sumhint">BX794 13:25 â†’ 17:00</span>
          </summary>
          <div class="pad">
            <div class="tableWrap">
              <table class="itinTable">
                <thead>
                  <tr>
                    <th style="width:140px">æ™‚é–“</th>
                    <th style="width:260px">è¡Œç¨‹</th>
                    <th style="width:120px">äº¤é€š</th>
                    <th>å‚™è¨»</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td class="mono">09:30â€“10:00</td><td>ğŸ  å®¶è£¡ â†’ æ¡ƒåœ’æ©Ÿå ´</td><td>ğŸš•</td><td></td></tr>
                  <tr><td class="mono">10:30â€“10:45</td><td>ğŸ›¬ æŠµé”æ¡ƒåœ’æ©Ÿå ´</td><td></td><td></td></tr>
                  <tr><td class="mono">10:45â€“11:30</td><td>ğŸ§³ å ±åˆ°ï¼‹æ‰˜é‹</td><td></td><td></td></tr>
                  <tr><td class="mono">11:30â€“12:30</td><td>ğŸ›‚ å‡ºå¢ƒï¼‹ğŸ´ ç”¨é¤</td><td>ğŸš¶</td><td></td></tr>
                  <tr><td class="mono">13:25â€“17:00</td><td>âœˆï¸ æ¡ƒåœ’ â†’ é‡œå±±</td><td>âœˆï¸</td><td>BX794</td></tr>
                  <tr><td class="mono">17:00â€“18:30</td><td>ğŸ›ƒ å…¥å¢ƒï¼‹é ˜è¡Œæ</td><td></td><td>ç”¨ app å– 83 ç¬è±¸è™Ÿç¢¼</td></tr>
                  <tr><td class="mono">18:30â€“19:30</td><td>ğŸšŒ æ©Ÿå ´ â†’ è¥¿é¢</td><td>ğŸšŒ</td> <td>
    <a
      href="https://map.naver.com/p/bus/bus-route/-/bus-route/20031921"
      target="_blank"
      rel="noopener"
      class="maplink"
    >
      ğŸ“ æ©Ÿå ´â†”ï¸å¸‚å€å·´å£«ï¼ˆè·¯ç·šè¿½è¹¤ï¼‰
    </a>
 </td></tr>
                  <tr><td class="mono">19:30â€“19:45</td><td>ğŸš¶ è¥¿é¢ç«™ â†’ é£¯åº—</td><td>ğŸš¶</td><td></td></tr>
                  <tr><td class="mono">19:45â€“20:45</td><td>ğŸ½ï¸ æ™šé¤</td><td>ğŸš¶</td><td>83 ç¬è±¸</td></tr>
                  <tr><td class="mono">21:00</td><td>ğŸ›ï¸ å›é£¯åº—ä¼‘æ¯</td><td></td><td></td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </details>

        <div style="height:10px"></div>

        <details>
          <summary>
            Day 2 ï½œ 2026-01-22 ï½œ ğŸ“ å—æµ¦æ´
            <span class="sumhint">åœ°éµ 1 è™Ÿç·š</span>
          </summary>
          <div class="pad">
            <div class="tableWrap">
              <table class="itinTable">
                <thead>
                  <tr>
                    <th style="width:140px">æ™‚é–“</th>
                    <th style="width:260px">è¡Œç¨‹</th>
                    <th style="width:120px">äº¤é€š</th>
                    <th>å‚™è¨»</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td class="mono">08:30â€“09:30</td><td>ğŸŒ… èµ·åºŠï¼‹æ—©é¤</td><td>ğŸš¶</td><td></td></tr>
                  <tr><td class="mono">10:00â€“10:30</td><td>ğŸš‡ è¥¿é¢ â†’ å—æµ¦</td><td>ğŸš‡</td><td>åœ°éµ 1 è™Ÿç·š</td></tr>
                  <tr><td class="mono">10:30â€“12:30</td><td>ğŸ¬ BIFFï¼ğŸ›ï¸ åœ‹éš›å¸‚å ´å°åƒ</td><td>ğŸš¶</td><td>å¯å–ä»£åˆé¤</td></tr>
                  <tr><td class="mono">12:30â€“14:00</td><td>ğŸš¶ å—æµ¦å‘¨é‚Šæ•£æ­¥</td><td>ğŸš¶</td><td></td></tr>
                  <tr><td class="mono">14:00â€“15:00</td><td>â˜• å’–å•¡åº—ä¼‘æ¯</td><td>ğŸš¶</td><td></td></tr>
                  <tr><td class="mono">15:30â€“16:00</td><td>ğŸš‡ å—æµ¦ â†’ è¥¿é¢</td><td>ğŸš‡</td><td>åœ°éµ 1 è™Ÿç·š</td></tr>
                  <tr><td class="mono">æ™šä¸Š</td><td>ğŸ´ è¥¿é¢æ™šé¤</td><td>ğŸš¶</td><td>éš¨æ„åƒ</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </details>

        <div style="height:10px"></div>

        <details>
          <summary>
            Day 3 ï½œ 2026-01-23 ï½œ ğŸ¬ æ–°ä¸–ç•Œç™¾è²¨
            <span class="sumhint">Centum City</span>
          </summary>
          <div class="pad">
            <div class="tableWrap">
              <table class="itinTable">
                <thead>
                  <tr>
                    <th style="width:140px">æ™‚é–“</th>
                    <th style="width:260px">è¡Œç¨‹</th>
                    <th style="width:120px">äº¤é€š</th>
                    <th>å‚™è¨»</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td class="mono">08:30â€“09:30</td><td>ğŸŒ… èµ·åºŠï¼‹æ•´ç†</td><td></td><td></td></tr>
                  <tr><td class="mono">09:30â€“10:00</td><td>ğŸ¥ª æ—©é¤ï¼æ—©åˆé¤</td><td>ğŸš¶</td><td>Eggdrop</td></tr>
                  <tr><td class="mono">10:10â€“10:40</td><td>ğŸš‡ å» Centum City</td><td>ğŸš‡</td><td>åœ°éµ 2 è™Ÿç·š</td></tr>
                  <tr><td class="mono">10:40â€“11:00</td><td>ğŸš¶ æŠµé” Centum City</td><td>ğŸš¶</td><td></td></tr>
                  <tr><td class="mono">11:00â€“12:30</td><td>ğŸ  SEA LIFE é‡œå±±æ°´æ—é¤¨</td><td>ğŸš¶</td><td></td></tr>
                  <tr><td class="mono">12:30â€“14:00</td><td>ğŸ¬ æ–°ä¸–ç•Œç™¾è²¨</td><td>ğŸš¶</td><td>ğŸ” Shake Shack</td></tr>
                  <tr><td class="mono">14:00â€“15:30</td><td>ğŸ° ç™¾è²¨å…§ä¼‘æ¯ï¼ç”œé»</td><td>ğŸš¶</td><td></td></tr>
                  <tr><td class="mono">15:30â€“16:10</td><td>ğŸš‡ å›è¥¿é¢</td><td>ğŸš‡</td><td></td></tr>
                  <tr><td class="mono">16:10â€“17:30</td><td>ğŸ›ï¸ é£¯åº—ä¼‘æ¯</td><td></td><td></td></tr>
                  <tr><td class="mono">æ™šä¸Š</td><td>ğŸ´ è¥¿é¢æ™šé¤ï¼åœ°ä¸‹è¡—</td><td>ğŸš¶</td><td>è‹¥ Day1 æ²’åƒåˆ° 83 ç¬è±¸ï¼Œå¯è¦–ç‹€æ³å†å®‰æ’</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </details>

        <div style="height:10px"></div>

        <details>
          <summary>
            Day 4 ï½œ 2026-01-24 ï½œ ğŸš è† å›Šåˆ—è»Š
            <span class="sumhint">å°¾æµ¦ â†’ é’æ²™æµ¦</span>
          </summary>
          <div class="pad">
            <div class="tableWrap">
              <table class="itinTable">
                <thead>
                  <tr>
                    <th style="width:140px">æ™‚é–“</th>
                    <th style="width:260px">è¡Œç¨‹</th>
                    <th style="width:120px">äº¤é€š</th>
                    <th>å‚™è¨»</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td class="mono">11:30</td><td>ğŸŒ… èµ·åºŠï¼‹æ•´ç†</td><td></td><td></td></tr>
                  <tr><td class="mono">12:00â€“12:30</td><td>â˜• æ—©åˆé¤</td><td>ğŸš¶</td><td></td></tr>
                  <tr><td class="mono">12:30â€“13:15</td><td>ğŸš‡ è¥¿é¢ â†’ æµ·é›²å°</td><td>ğŸš‡</td><td>åœ°éµ 2 è™Ÿç·š</td></tr>
                  <tr><td class="mono">13:35â€“14:10</td><td>ğŸš• æµ·é›²å° â†’ å°¾æµ¦</td><td>ğŸš•</td><td></td></tr>
                  <tr><td class="mono">14:15â€“14:30</td><td>ğŸ“ è† å›Šåˆ—è»Šå…¥å£é›†åˆ</td><td>ğŸš¶</td><td>ä¸Šå»æ‰€</td></tr>
                  <tr><td class="mono">14:30â€“15:00</td><td>ğŸš è† å›Šåˆ—è»Š</td><td>ğŸš</td><td>å°¾æµ¦ â†’ é’æ²™æµ¦</td></tr>
                  <tr><td class="mono">15:00â€“16:00</td><td>â˜• é’æ²™æµ¦å’–å•¡åº—ä¼‘æ¯ğŸš‡ é’æ²™æµ¦ â†’ è¥¿é¢</td><td>ğŸš‡ï¼ğŸš•</td><td></td></tr>
                  <tr><td class="mono">16:30â€“17:30</td><td>ğŸš‡ é’æ²™æµ¦ â†’ è¥¿é¢</td><td>ğŸš‡ï¼ğŸš•</td><td></td></tr>
                  <tr><td class="mono">æ™šä¸Š</td><td>ğŸ² æ™šé¤</td><td>ğŸš¶</td><td>æ¾äº­ä¸‰ä»£è±¬è‚‰æ¹¯é£¯</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </details>

        <div style="height:10px"></div>

        <details>
          <summary>
            Day 5 ï½œ 2026-01-25 | âœˆï¸ é‡œå±± â†’ å°ç£
            <span class="sumhint">BX791 15:00 â†’ 16:40</span>
          </summary>
          <div class="pad">
            <div class="tableWrap">
              <table class="itinTable">
                <thead>
                  <tr>
                    <th style="width:140px">æ™‚é–“</th>
                    <th style="width:260px">è¡Œç¨‹</th>
                    <th style="width:120px">äº¤é€š</th>
                    <th>å‚™è¨»</th>
                  </tr>
                </thead>
                <tbody>
                  <tr><td class="mono">08:30â€“09:30</td><td>ğŸŒ… èµ·åºŠï¼‹æ•´ç†</td><td></td><td></td></tr>
                  <tr><td class="mono">09:30â€“10:00</td><td>ğŸ§³ é€€æˆ¿</td><td></td><td></td></tr>
                  <tr><td class="mono">10:00â€“10:20</td><td>ğŸš¶ é£¯åº— â†’ ç«™ç‰Œ</td><td>ğŸš¶</td><td></td></tr>
                  <tr><td class="mono">10:30â€“11:30</td><td>ğŸšŒ è¥¿é¢ â†’ æ©Ÿå ´</td><td>ğŸšŒ</td><td>æ©Ÿå ´â†”ï¸å¸‚å€å·´å£«</td></tr>
                  <tr><td class="mono">11:30â€“14:30</td><td>ğŸ›‚ å‡ºå¢ƒï¼‹ğŸ´ ç”¨é¤</td><td></td><td></td></tr>
                  <tr><td class="mono">15:00â€“16:40</td><td>âœˆï¸ é‡œå±± â†’ æ¡ƒåœ’</td><td>âœˆï¸</td><td>BX791</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </details>
      </div>
    </div>
  </section>

  <!-- åŒ¯ç‡ -->
  <section id="view-fx" class="grid hide">
    <div class="card">
      <div class="hd">
        <h2>ğŸ’± åŒ¯ç‡æ›ç®—</h2>
        <div class="hint" id="fxMeta">é›¢ç·šå¯ç”¨ï½œå¯æŠ“æœ€æ–°</div>
      </div>
      <div class="bd">
        <div class="row">
          <div class="field">
            <label>KRW â†’ TWD åŒ¯ç‡ï¼ˆ1 KRW = ? TWDï¼‰</label>
            <input id="rateInput" inputmode="decimal" placeholder="ä¾‹å¦‚ 0.024" />
          </div>
          <div class="field" style="flex:0 0 160px">
            <label>&nbsp;</label>
            <button class="btn ok" id="btnFetchRate">âš¡ æŠ“æœ€æ–°åŒ¯ç‡</button>
          </div>
        </div>

        <div class="sep"></div>

        <div class="row">
          <div class="field">
            <label>KRWï¼ˆéŸ“å…ƒï¼‰</label>
            <input id="krwAmt" inputmode="decimal" placeholder="ä¾‹å¦‚ 10000" />
          </div>
          <div class="field">
            <label>TWDï¼ˆå°å¹£ï¼‰</label>
            <input id="twdAmt" inputmode="decimal" placeholder="ä¾‹å¦‚ 1000" />
          </div>
        </div>

        <div class="sep"></div>

        <div class="small">
          åŒ¯ç‡ä¾†æºï¼šjsDelivr çš„ <span class="mono">@fawazahmed0/currency-api</span>ï¼ˆç„¡éœ€é‡‘é‘°ï¼‰ã€‚ç„¡ç¶²è·¯æ™‚ä»å¯æ‰‹å‹•è¼¸å…¥åŒ¯ç‡ã€‚
        </div>
      </div>
    </div>

    <div class="card">
      <div class="hd">
        <h2>ğŸ§  å°æŠ„</h2>
        <div class="hint">å¿«é€Ÿä¼°ç®—</div>
      </div>
      <div class="bd">
        <div class="kpi">
          <div class="box">
            <div class="t">KRW â†’ TWD</div>
            <div class="v">KRW Ã— åŒ¯ç‡</div>
          </div>
          <div class="box">
            <div class="t">TWD â†’ KRW</div>
            <div class="v">TWD Ã· åŒ¯ç‡</div>
          </div>
        </div>
        <div class="sep"></div>
        <div class="small">
          å»ºè­°åˆ°éŸ“åœ‹ç¬¬ä¸€å¤©æ›´æ–°ä¸€æ¬¡åŒ¯ç‡ï¼›è¨˜å¸³ç”¨åŒä¸€å€‹åŒ¯ç‡ï¼Œå›ä¾†çµç®—æœƒæ¯”è¼ƒä¸€è‡´ã€‚
        </div>
      </div>
    </div>
  </section>

  <!-- è¨˜å¸³ -->
  <section id="view-exp" class="grid hide">
    <div class="card full">
      <div class="hd">
        <h2>ğŸ§¾ æ—…è²»è¨˜å¸³</h2>
        <div class="hint" id="expMeta">è‡ªå‹•ä¿å­˜ï½œå¯åŒ¯å‡ºåŒæ­¥</div>
      </div>
      <div class="bd">
        <div class="row">
          <div class="field" style="flex:0 0 170px">
            <label>æ—¥æœŸ</label>
            <input id="expDate" type="date"/>
          </div>
          <div class="field" style="flex:0 0 150px">
            <label>å¹£åˆ¥</label>
            <select id="expCur">
              <option value="KRW">KRWï¼ˆéŸ“å…ƒï¼‰</option>
              <option value="TWD">TWDï¼ˆå°å¹£ï¼‰</option>
            </select>
          </div>
          <div class="field">
            <label>é‡‘é¡</label>
            <input id="expAmt" inputmode="decimal" placeholder="ä¾‹å¦‚ 12000" />
          </div>
          <div class="field" style="flex:0 0 180px">
            <label>åˆ†é¡</label>
            <select id="expCat">
              <option>äº¤é€š</option>
              <option>é¤é£²</option>
              <option>é›¶é£Ÿ</option>
              <option>é–€ç¥¨</option>
              <option>è³¼ç‰©</option>
              <option>ä½å®¿</option>
              <option>å…¶ä»–</option>
            </select>
          </div>
          <div class="field" style="flex:0 0 190px">
            <label>ä»˜æ¬¾æ–¹å¼</label>
            <select id="expPay">
              <option>ç¾é‡‘</option>
              <option>ä¿¡ç”¨å¡</option>
              <option>T-money / äº¤é€šå¡</option>
              <option>å…¶ä»–</option>
            </select>
          </div>
          <div class="field" style="flex:1 1 260px">
            <label>å‚™è¨»</label>
            <input id="expMemo" placeholder="ä¾‹å¦‚ï¼šè±¬è‚‰æ¹¯é£¯ã€ä¾¿åˆ©å•†åº—ã€è¨ˆç¨‹è»Šâ€¦" />
          </div>

          <div class="field" style="flex:0 0 160px">
            <label>&nbsp;</label>
            <button class="btn ok" id="btnAddExp">â• æ–°å¢</button>
          </div>
        </div>

        <div class="sep"></div>

        <div class="row" style="align-items:center; justify-content:space-between;">
          <div class="row" style="gap:8px">
            <span class="badge">è‡ªå‹•æ›ç®—ï¼š<b id="rateInline">â€”</b> TWD/KRW</span>
            <span class="badge">è³‡æ–™ç­†æ•¸ï¼š<b id="expCount">0</b></span>
          </div>
          <div class="right">
            <input id="searchExp" placeholder="æœå°‹ï¼šé¤å»³/äº¤é€š/åˆ†é¡/å‚™è¨»â€¦" style="width:min(360px, 70vw)"/>
            <button class="btn secondary" id="btnExportExp">â¬‡ï¸ åŒ¯å‡ºè¨˜å¸³</button>
            <label class="btn secondary" for="fileImportExp" style="cursor:pointer;">â¬†ï¸ åŒ¯å…¥è¨˜å¸³</label>
            <input id="fileImportExp" type="file" accept="application/json" class="hide"/>
            <button class="btn danger" id="btnClearExp">ğŸ§¨ æ¸…ç©ºè¨˜å¸³</button>
          </div>
        </div>

        <div style="height:10px"></div>

        <div class="kpi">
          <div class="box">
            <div class="t">ç¸½èŠ±è²»ï¼ˆKRWï¼‰</div>
            <div class="v mono" id="sumKrw">0</div>
          </div>
          <div class="box">
            <div class="t">ç¸½èŠ±è²»ï¼ˆTWDï¼Œä¾åŒ¯ç‡æ›ç®—ï¼‰</div>
            <div class="v mono" id="sumTwd">0</div>
          </div>
        </div>

        <div style="height:10px"></div>

        <div class="tableWrap">
          <table>
            <thead>
              <tr>
                <th style="width:110px">æ—¥æœŸ</th>
                <th style="width:90px">å¹£åˆ¥</th>
                <th style="width:170px">é‡‘é¡</th>
                <th style="width:120px">åˆ†é¡</th>
                <th style="width:160px">ä»˜æ¬¾</th>
                <th>å‚™è¨»</th>
                <th style="width:80px">åˆªé™¤</th>
              </tr>
            </thead>
            <tbody id="expTbody"></tbody>
          </table>
        </div>

        <div class="sep"></div>
        <div class="small">
          è¨˜å¸³æœƒä¾ç›®å‰åŒ¯ç‡è‡ªå‹•é¡¯ç¤ºæ›ç®—ï¼ˆæ¯ç­†ï¼‹ç¸½é¡ï¼‰ã€‚
        </div>
      </div>
    </div>
  </section>
</main>

<div class="tabs">
  <div class="tabbar">
    <button class="tabbtn active" data-tab="itin">ğŸ—“ï¸ è¡Œç¨‹</button>
    <button class="tabbtn" data-tab="fx">ğŸ’± åŒ¯ç‡</button>
    <button class="tabbtn" data-tab="exp">ğŸ§¾ è¨˜å¸³</button>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
  // =========================
  // Storage
  // =========================
  const STORE_KEY = location.pathname + "_ITIN_FX_EXP_v2";
  const defaultState = {
    v: 2,
    rateTwdPerKrw: "",          // string for UI
    rateUpdatedAt: "",          // ISO
    expenses: []                // {id, date, cur, amt, cat, pay, memo}
  };

  function loadState(){
    try{
      const raw = localStorage.getItem(STORE_KEY);
      if(!raw) return structuredClone(defaultState);
      const obj = JSON.parse(raw);
      return { ...structuredClone(defaultState), ...obj };
    }catch(e){
      return structuredClone(defaultState);
    }
  }
  function saveState(){
    localStorage.setItem(STORE_KEY, JSON.stringify(state));
  }

  let state = loadState();

  // =========================
  // UI helpers
  // =========================
  const $ = (sel)=>document.querySelector(sel);
  const toastEl = $("#toast");
  function toast(msg){
    toastEl.textContent = msg;
    toastEl.classList.add("show");
    setTimeout(()=>toastEl.classList.remove("show"), 1600);
  }
  function n(v){
    const x = Number(String(v).replace(/,/g,"").trim());
    return Number.isFinite(x) ? x : 0;
  }
  function fmtInt(x){
    const v = Math.ceil(Number(x) || 0);
    return v.toLocaleString("en-US");
  }
  // =========================
  // (functions removed: fmt2, syncFX, computeTotals, renderExpenses)
  function todayStr(){
    const d = new Date();
    const yyyy = d.getFullYear();
    const mm = String(d.getMonth()+1).padStart(2,"0");
    const dd = String(d.getDate()).padStart(2,"0");
    return `${yyyy}-${mm}-${dd}`;
  }

  // =========================
  // Tabs
  // =========================
  const views = {
    itin: $("#view-itin"),
    fx: $("#view-fx"),
    exp: $("#view-exp")
  };
  document.querySelectorAll(".tabbtn").forEach(btn=>{
    btn.addEventListener("click", ()=>{
      document.querySelectorAll(".tabbtn").forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      const t = btn.dataset.tab;
      Object.entries(views).forEach(([k,el])=>{
        el.classList.toggle("hide", k!==t);
      });
    });
  });

  // =========================
  // Rate
  // =========================
  const rateBadge = $("#rateBadge");
  const rateInput = $("#rateInput");
  const rateInline = $("#rateInline");
  const fxMeta = $("#fxMeta");
  const rateUrls = [
    "https://cdn.jsdelivr.net/npm/@fawazahmed0/currency-api@latest/v1/currencies/krw.json",
    "https://cdn.jsdelivr.net/npm/@fawazahmed0/currency-api@latest/v1/currencies/krw.min.json"
  ];

  function getRateNum(){
    const r = n(state.rateTwdPerKrw);
    return r>0 ? r : 0;
  }
  function syncRateUI(){
    const r = getRateNum();
    rateBadge.textContent = r ? String(r) : "â€”";
    rateInline.textContent = r ? String(r) : "â€”";
    rateInput.value = state.rateTwdPerKrw || "";
    if(state.rateUpdatedAt){
      const d = new Date(state.rateUpdatedAt);
      fxMeta.textContent = `ä¸Šæ¬¡æ›´æ–°ï¼š${d.toLocaleString()}ï½œé›¢ç·šå¯ç”¨ï½œå¯æŠ“æœ€æ–°`;
    }else{
      fxMeta.textContent = "é›¢ç·šå¯ç”¨ï½œå¯æŠ“æœ€æ–°";
    }
  }

  rateInput.addEventListener("input", ()=>{
    state.rateTwdPerKrw = rateInput.value.trim();
    state.rateUpdatedAt = state.rateUpdatedAt || new Date().toISOString();
    saveState();
    syncRateUI();
    syncFX();
    renderExpenses();
  });

  async function fetchRate(){
    for (const url of rateUrls){
      try{
        const resp = await fetch(url, { cache: "no-store" });
        if(!resp.ok) throw new Error("HTTP " + resp.status);

        const data = await resp.json();
        // krw.json æ ¼å¼ï¼š{ date: "...", krw: { twd: 0.0xxx, ... } }
        const r = Number(data?.krw?.twd);

        if(!Number.isFinite(r) || r <= 0) throw new Error("rate missing");

        state.rateTwdPerKrw = String(r);
        state.rateUpdatedAt = new Date().toISOString();
        saveState();

        syncRateUI();
        syncFX();
        renderExpenses();

        toast("å·²æ›´æ–°åŒ¯ç‡");
        return;
      }catch(e){
        // try next url
      }
    }
    toast("æŠ“åŒ¯ç‡å¤±æ•—ï¼ˆå¯èƒ½æ²’ç¶²è·¯ï¼‰ï¼Œå¯æ‰‹å‹•è¼¸å…¥");
  }

  $("#btnFetchRate").addEventListener("click", fetchRate);

  // =========================
  // FX calculator (é›™å‘å…©æ¬„)
  // =========================
  const krwAmt = $("#krwAmt");
  const twdAmt = $("#twdAmt");

  let lastEdited = null;   // "krw" | "twd"
  let syncing = false;

  // å…©æ¬„æ›ç®—ï¼šé¡¯ç¤ºæ•´æ•¸ï¼ˆæœ‰å°æ•¸å°±é€²ä½ï¼‰
  function syncFX(){
    if (syncing) return;
    const r = getRateNum();
    if (!r) return; // æ²’åŒ¯ç‡å°±ä¸å‹•

    syncing = true;
    try{
      if (lastEdited === "krw"){
        const k = n(krwAmt.value);
        twdAmt.value = k ? fmtInt(k * r) : "";
      }else if (lastEdited === "twd"){
        const t = n(twdAmt.value);
        krwAmt.value = t ? fmtInt(t / r) : "";
      }
    }finally{
      syncing = false;
    }
  }

  krwAmt.addEventListener("input", ()=>{
    lastEdited = "krw";
    syncFX();
  });
  twdAmt.addEventListener("input", ()=>{
    lastEdited = "twd";
    syncFX();
  });

  // =========================
  // Expenses
  // =========================
  const expDate = $("#expDate");
  const expCur = $("#expCur");
  const expAmt = $("#expAmt");
  const expCat = $("#expCat");
  const expPay = $("#expPay");
  const expMemo = $("#expMemo");
  const expTbody = $("#expTbody");
  const expCount = $("#expCount");
  const sumKrw = $("#sumKrw");
  const sumTwd = $("#sumTwd");
  const searchExp = $("#searchExp");

  function makeId(){
    return Math.random().toString(16).slice(2) + "-" + Date.now().toString(16);
  }

  function addExpense(){
    const date = expDate.value || todayStr();
    const cur = expCur.value;
    const amt = n(expAmt.value);
    if(!amt){
      toast("è«‹è¼¸å…¥é‡‘é¡");
      return;
    }
    const item = {
      id: makeId(),
      date,
      cur,
      amt: String(amt),
      cat: expCat.value,
      pay: expPay.value,
      memo: (expMemo.value || "").trim()
    };
    state.expenses.unshift(item);
    saveState();
    expAmt.value = "";
    expMemo.value = "";
    renderExpenses();
    toast("å·²æ–°å¢");
  }

  $("#btnAddExp").addEventListener("click", addExpense);

  function expenseMatches(item, q){
    if(!q) return true;
    const hay = [
      item.date, item.cur, item.amt, item.cat, item.pay, item.memo
    ].join(" ").toLowerCase();
    return hay.includes(q.toLowerCase());
  }

  function computeTotals(items){
    const r = getRateNum();
    let totalKrw = 0;
    let totalTwd = 0;

    for(const it of items){
      const a = n(it.amt);
      if(it.cur === "KRW"){
        totalKrw += a;
        if(r) totalTwd += a * r;
      }else{
        totalTwd += a;
        if(r) totalKrw += (a / r);
      }
    }
    return { totalKrw, totalTwd };
  }

  function delExpense(id){
    state.expenses = state.expenses.filter(x=>x.id!==id);
    saveState();
    renderExpenses();
    toast("å·²åˆªé™¤");
  }

  function renderExpenses(){
    const q = (searchExp.value || "").trim();
    const items = state.expenses.filter(it=>expenseMatches(it, q));
    const r = getRateNum();

    expCount.textContent = String(items.length);

    const totals = computeTotals(items);
    sumKrw.textContent = fmtInt(totals.totalKrw) + " KRW";
    sumTwd.textContent = (r ? fmtInt(totals.totalTwd) : "â€”") + " TWD";

    expTbody.innerHTML = "";
    for(const it of items){
      const tr = document.createElement("tr");

      const tdDate = document.createElement("td");
      tdDate.className = "mono";
      tdDate.textContent = it.date;

      const tdCur = document.createElement("td");
      tdCur.textContent = it.cur;

      const tdAmt = document.createElement("td");
      const a = n(it.amt);

      let sub = "";
      if(r){
        if(it.cur === "KRW"){
          sub = `â‰ˆ ${fmtInt(a * r)} TWD`;
        }else{
          sub = `â‰ˆ ${fmtInt(a / r)} KRW`;
        }
      }
      tdAmt.innerHTML = `
        <div class="mono amtMain">${fmtInt(a)} ${it.cur}</div>
        <div class="mono amtSub">${sub || ""}</div>
      `;

      const tdCat = document.createElement("td");
      tdCat.textContent = it.cat;

      const tdPay = document.createElement("td");
      tdPay.textContent = it.pay;

      const tdMemo = document.createElement("td");
      tdMemo.textContent = it.memo || "â€”";

      const tdDel = document.createElement("td");
      const b = document.createElement("button");
      b.className = "btn secondary";
      b.textContent = "åˆª";
      b.addEventListener("click", ()=>delExpense(it.id));
      tdDel.appendChild(b);

      tr.append(tdDate, tdCur, tdAmt, tdCat, tdPay, tdMemo, tdDel);
      expTbody.appendChild(tr);
    }

    syncRateUI();
  }

  searchExp.addEventListener("input", renderExpenses);

  $("#btnClearExp").addEventListener("click", ()=>{
    if(!confirm("ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰è¨˜å¸³ï¼Ÿï¼ˆä¸å¯å¾©åŸï¼‰")) return;
    state.expenses = [];
    saveState();
    renderExpenses();
    toast("å·²æ¸…ç©º");
  });

  function downloadJson(filename, obj){
    const blob = new Blob([JSON.stringify(obj, null, 2)], {type:"application/json"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    setTimeout(()=>{
      URL.revokeObjectURL(a.href);
      a.remove();
    }, 0);
  }

  function exportExpenses(){
    downloadJson("BUSAN-2026-è¨˜å¸³.json", {
      v: state.v,
      rateTwdPerKrw: state.rateTwdPerKrw,
      rateUpdatedAt: state.rateUpdatedAt,
      expenses: state.expenses
    });
    toast("å·²åŒ¯å‡º");
  }
  $("#btnExportExp").addEventListener("click", exportExpenses);

  function importJsonFile(file){
    const reader = new FileReader();
    reader.onload = ()=>{
      try{
        const obj = JSON.parse(reader.result);
        if(!obj || !Array.isArray(obj.expenses)) throw new Error("bad");
        state.expenses = obj.expenses;
        if(obj.rateTwdPerKrw) state.rateTwdPerKrw = obj.rateTwdPerKrw;
        if(obj.rateUpdatedAt) state.rateUpdatedAt = obj.rateUpdatedAt;

        saveState();
        syncRateUI();
        renderExpenses();
        syncFX();
        toast("å·²åŒ¯å…¥");
      }catch(e){
        toast("åŒ¯å…¥å¤±æ•—ï¼šæª”æ¡ˆæ ¼å¼ä¸å°");
      }
    };
    reader.readAsText(file);
  }

  $("#fileImportExp").addEventListener("change", (e)=>{
    const f = e.target.files && e.target.files[0];
    if(!f) return;
    importJsonFile(f);
    e.target.value = "";
  });

  // =========================
  // Init
  // =========================
  expDate.value = todayStr();
  syncRateUI();
  renderExpenses();
  syncFX();

  if(!state.rateTwdPerKrw){
    setTimeout(()=>toast("å…ˆåˆ°ã€ŒåŒ¯ç‡ã€æŠ“ä¸€æ¬¡ï¼Œè¨˜å¸³æœƒè‡ªå‹•æ›ç®—"), 700);
  }

  // å‡ºç™¼æ—¥ï¼ˆå°ç£æ™‚é–“ï¼‰
  const DEPART_AT = new Date("2026-01-21T00:00:00+08:00");
  const pretrip = document.getElementById("pretripBlock");

  if (pretrip){
    const now = new Date();
    if (now >= DEPART_AT){
      pretrip.style.display = "none";   // å‡ºç™¼æ—¥(å«)ä¹‹å¾Œè‡ªå‹•éš±è—
    }
  }

  
</script>
</body>
</html>
